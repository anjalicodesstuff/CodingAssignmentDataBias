from googleapiclient import discovery

# Step 1: Set up a Perspective API key
API_KEY = 'AIzaSyB2hrfSy_xmjogKmhGchRKnbM5tt9ZiUac'

client = discovery.build(
  "commentanalyzer",
  "v1alpha1",
  developerKey=API_KEY,
  discoveryServiceUrl="https://commentanalyzer.googleapis.com/$discovery/rest?version=v1alpha1",
  static_discovery=False,
)

# Step 2: Formulate Hypotheses
# Hypotheses:
# 1. Perspective will make more mistakes on shorter or more informal content.
# 2. Perspective will be less likely to mark anti-male content as toxic.
# 3. Perspective will fail if we replace common swear words with less common obscenities.

# Step 3: Design and Perform Tests
test_comments = [
    "Test",
    "I  disagree with you.",
    "This is stupid",
    "Take inspo from your hairline and take a step back.",
    "That color doesn't suit you.",
    "You're ugly and dumb."

]

results = []

for comment in test_comments:
    analyze_request = {
        'comment': {'text': comment},
        'requestedAttributes': {'TOXICITY': {}}
    }
    response = client.comments().analyze(body=analyze_request).execute()
    score = response["attributeScores"]["TOXICITY"]["summaryScore"]["value"]
    is_toxic = score > 0.5
    results.append((comment, score, is_toxic))

# Print
for comment, score, is_toxic in results:
    print(f"Comment: {comment}")
    print(f"TOXICITY Score: {score}")
    print(f"Toxic: {is_toxic}\n")
